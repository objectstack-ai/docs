---
title: Platform Architecture
description: How ObjectOS binds ObjectQL and ObjectUI together with Local-First implementation
---

# Platform Architecture

ObjectOS serves as the runtime platform that orchestrates ObjectQL (data engine) and ObjectUI (interface framework) into a cohesive application environment. This page explains how ObjectOS binds these components together and implements Local-First architecture.

## Architecture Overview

ObjectOS is structured in three primary layers:

```
┌─────────────────────────────────────────────────────┐
│              Application Layer                      │
│  ┌──────────────┐  ┌──────────────┐                │
│  │   Business   │  │    Custom    │                │
│  │    Logic     │  │  Components  │                │
│  └──────────────┘  └──────────────┘                │
└────────────────────┬────────────────────────────────┘
                     │
┌────────────────────▼────────────────────────────────┐
│              ObjectOS Platform                      │
│  ┌──────────────────────────────────────────────┐  │
│  │         Runtime Binding Layer                │  │
│  │  ┌────────────────┬────────────────────────┐ │  │
│  │  │  Schema-UI     │   Data-Component       │ │  │
│  │  │   Mapping      │   Synchronization      │ │  │
│  │  └────────────────┴────────────────────────┘ │  │
│  └──────────────────────────────────────────────┘  │
│  ┌──────────────────────────────────────────────┐  │
│  │         Platform Services Layer              │  │
│  │  ┌───────┬───────┬─────────┬──────────────┐ │  │
│  │  │ Auth  │ RBAC  │   FLS   │ Multi-tenant │ │  │
│  │  └───────┴───────┴─────────┴──────────────┘ │  │
│  └──────────────────────────────────────────────┘  │
│  ┌────────────┬────────────────────┐              │
│  │  ObjectUI  │     ObjectQL       │              │
│  │ Components │   Data Engine      │              │
│  └────────────┴────────────────────┘              │
└─────────────────────────────────────────────────────┘
```

## QL-UI Binding Mechanism

ObjectOS automatically connects ObjectQL schemas with ObjectUI components through a declarative binding system.

### Schema-Driven UI Generation

When you define an object schema, ObjectOS automatically generates appropriate UI components:

```typescript
// Schema definition (ObjectQL)
const schema = {
  objects: {
    contacts: {
      label: 'Contacts',
      fields: {
        name: { 
          type: 'text', 
          label: 'Name',
          required: true 
        },
        email: { 
          type: 'email', 
          label: 'Email' 
        },
        company: { 
          type: 'lookup',
          reference_to: 'companies',
          label: 'Company'
        },
        status: {
          type: 'select',
          options: ['active', 'inactive'],
          label: 'Status'
        }
      }
    }
  }
}

// ObjectOS automatically generates:
// - Form components with proper inputs
// - List views with sortable columns
// - Detail views with formatted fields
// - Lookup selectors for relationships
```

### Component-to-Data Binding

ObjectUI components automatically bind to ObjectQL data:

```typescript
// Page definition (ObjectUI)
const pages = {
  contacts: {
    type: 'list',
    object: 'contacts',  // Auto-binds to schema
    fields: ['name', 'email', 'company', 'status'],
    filters: {
      status: 'active'
    }
  },
  contactDetail: {
    type: 'detail',
    object: 'contacts',  // Auto-binds to schema
    layout: [
      { field: 'name' },
      { field: 'email' },
      { field: 'company' },  // Renders lookup selector
      { field: 'status' }    // Renders dropdown
    ]
  }
}
```

### Real-Time Data Synchronization

ObjectOS maintains bidirectional sync between UI and data:

```typescript
// When user edits a field in UI:
// 1. ObjectUI captures the change
// 2. ObjectOS validates against schema
// 3. ObjectQL persists to database
// 4. ObjectOS broadcasts update
// 5. All UI components refresh automatically

const app = new ObjectOS({
  schema,
  pages,
  reactivity: {
    enabled: true,        // Enable real-time sync
    debounce: 300,       // Debounce updates (ms)
    optimistic: true     // Optimistic UI updates
  }
})
```

## Local-First Implementation

ObjectOS implements Local-First architecture principles, making applications work seamlessly offline while supporting optional cloud synchronization.

### Storage Architecture

```
┌─────────────────────────────────────────────────┐
│           Application Runtime                   │
└────────────────┬────────────────────────────────┘
                 │
┌────────────────▼────────────────────────────────┐
│         ObjectOS Storage Layer                  │
│  ┌──────────────────────────────────────────┐  │
│  │      Local Storage (SQLite)              │  │
│  │  ┌─────────┬──────────┬───────────────┐  │  │
│  │  │ App Data│ User Data│  System Data  │  │  │
│  │  └─────────┴──────────┴───────────────┘  │  │
│  └──────────────────────────────────────────┘  │
│  ┌──────────────────────────────────────────┐  │
│  │    Sync Engine (Optional)                │  │
│  │  ┌────────────┬──────────────────────┐   │  │
│  │  │ Change Log │  Conflict Resolution │   │  │
│  │  └────────────┴──────────────────────┘   │  │
│  └──────────────────────────────────────────┘  │
└─────────────────────────────────────────────────┘
                 │
                 │ (Optional sync)
                 │
┌────────────────▼────────────────────────────────┐
│          Remote Server (Optional)               │
└─────────────────────────────────────────────────┘
```

### Standalone Mode (Pure Local-First)

In standalone mode, everything runs locally:

```typescript
const app = new ObjectOS({
  mode: 'standalone',
  storage: {
    type: 'sqlite',
    path: './myapp.db'    // Local SQLite file
  },
  offline: {
    enabled: true,         // Full offline support
    persistQueries: true   // Cache queries locally
  }
})

// Application works 100% offline:
// - All data stored locally
// - No network required
// - Instant performance
// - User owns their data
```

### Hybrid Mode (Local-First + Sync)

Applications can sync with remote servers when online:

```typescript
const app = new ObjectOS({
  mode: 'hybrid',
  storage: {
    type: 'sqlite',
    path: './myapp.db'
  },
  sync: {
    enabled: true,
    remote: 'https://api.example.com',
    strategy: 'eventual',  // Eventual consistency
    interval: 60000,       // Sync every 60s when online
    conflictResolution: 'last-write-wins'
  }
})

// Benefits:
// - Works offline first
// - Syncs when network available
// - Handles conflicts automatically
// - Fast local operations
```

### Data Persistence

ObjectOS ensures data durability:

```typescript
const app = new ObjectOS({
  storage: {
    type: 'sqlite',
    path: './myapp.db',
    persistence: {
      wal: true,              // Write-Ahead Logging
      autoCheckpoint: 1000,   // Checkpoint every 1000 pages
      backup: {
        enabled: true,
        interval: 3600000,    // Hourly backups
        retention: 7          // Keep 7 backups
      }
    }
  }
})
```

## Runtime Lifecycle

Understanding the ObjectOS lifecycle helps optimize application behavior:

### Initialization Phase

```typescript
const app = new ObjectOS({ /* config */ })

// Phase 1: Initialize core services
await app.initialize()
// - Load configuration
// - Setup storage layer
// - Initialize ObjectQL engine
// - Register schemas

// Phase 2: Start platform services
await app.start()
// - Initialize auth system
// - Load user permissions
// - Start UI runtime
// - Bind components to data
// - Begin sync (if configured)

console.log('App ready at', app.url)
```

### Request Handling

```typescript
// Incoming request flow:
Request → ObjectOS Router
         ↓
    Auth Middleware (verify user)
         ↓
    Permission Check (RBAC + FLS)
         ↓
    ObjectQL Query (with filters)
         ↓
    ObjectUI Render (with data)
         ↓
    Response
```

### Shutdown Phase

```typescript
// Graceful shutdown
process.on('SIGTERM', async () => {
  await app.shutdown({
    // Complete pending writes
    flushWrites: true,
    // Checkpoint WAL
    checkpoint: true,
    // Close connections
    closeConnections: true,
    // Timeout in ms
    timeout: 5000
  })
})
```

## Configuration Options

Complete ObjectOS configuration reference:

```typescript
const app = new ObjectOS({
  // Deployment mode
  mode: 'standalone' | 'server' | 'multi-tenant',
  
  // Storage configuration
  storage: {
    type: 'sqlite' | 'mysql' | 'postgresql',
    path: './data.db',           // SQLite path
    url: 'mysql://...',          // Or connection URL
    pool: {
      min: 2,
      max: 10
    }
  },
  
  // Schema definition
  schema: {
    objects: { /* ... */ }
  },
  
  // UI pages
  pages: {
    /* ... */
  },
  
  // Authentication
  auth: {
    enabled: true,
    providers: ['email', 'oauth'],
    session: {
      secret: 'your-secret',
      maxAge: 86400000
    }
  },
  
  // Sync configuration (Local-First)
  sync: {
    enabled: false,
    remote: 'https://api.example.com',
    strategy: 'eventual' | 'manual',
    interval: 60000,
    conflictResolution: 'last-write-wins' | 'manual'
  },
  
  // Server settings
  server: {
    port: 3000,
    host: '0.0.0.0'
  },
  
  // Multi-tenant settings
  multiTenant: {
    enabled: false,
    strategy: 'virtualCity' | 'database',
    isolation: 'strict' | 'shared-schema'
  }
})
```

## Performance Optimization

ObjectOS includes several optimization strategies:

### Query Optimization

```typescript
const app = new ObjectOS({
  performance: {
    // Enable query result caching
    queryCache: {
      enabled: true,
      maxSize: 100,        // Cache 100 queries
      ttl: 60000          // 60s TTL
    },
    
    // Optimize Virtual Column Index (SQLite)
    virtualColumnIndex: true,
    
    // Batch mutations
    batchMutations: {
      enabled: true,
      maxSize: 100,
      flushInterval: 1000
    }
  }
})
```

### UI Rendering Optimization

```typescript
const pages = {
  largeList: {
    type: 'list',
    object: 'records',
    performance: {
      virtualScroll: true,     // Render only visible rows
      pageSize: 50,            // Load 50 at a time
      lazyLoad: true,          // Load on scroll
      memoizeRows: true        // Cache rendered rows
    }
  }
}
```

## Next Steps

Now that you understand the platform architecture:

- **[Identity & Access](/docs/objectos/identity-access)** - Learn about user management and RBAC
- **[Deployment](/docs/objectos/deployment)** - Deploy ObjectOS applications
