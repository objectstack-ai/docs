---
title: ObjectOS - 运行时与平台
description: 将数据与界面绑定在一起的运行时平台,实现本地优先架构
---

# ObjectOS - 运行时与平台

ObjectOS 是将 ObjectQL(数据)和 ObjectUI(界面)整合在一起的运行时平台,提供完整的应用环境,包括身份管理、访问控制和灵活的部署选项。

## 什么是 ObjectOS?

ObjectOS 是**运行时平台**,它编排整个 ObjectStack。它将数据层(ObjectQL)与展示层(ObjectUI)绑定,同时提供用户管理、安全和部署等关键平台服务。

### 核心能力

- 🔗 **QL-UI 绑定** - 无缝连接数据引擎与 UI 框架
- 🏠 **本地优先架构** - 应用完全在本地设备上运行
- 👥 **身份与访问管理** - 内置用户系统和 RBAC
- 🔒 **字段级安全** - 细粒度的数据访问控制
- 🚀 **灵活部署** - 独立 .oos 文件或 Docker 容器
- 🏢 **多租户就绪** - 支持 SaaS 场景的租户隔离

## 工作原理

ObjectOS 作为运行时环境提供以下能力:

### 1. 绑定数据与界面

ObjectOS 在 ObjectQL 和 ObjectUI 之间创建双向桥接:

```typescript
// ObjectOS 自动连接数据和界面
const app = new ObjectOS({
  schema: './schema',      // ObjectQL schemas
  pages: './pages',        // ObjectUI 组件
  storage: './data'        // 本地优先存储
})

await app.start()
```

### 2. 管理平台服务

提供核心平台能力:

- **用户系统** - `_users` 对象中的认证和用户资料
- **角色管理** - `_roles` 对象中的灵活角色定义
- **权限控制** - 支持字段级安全的 RBAC
- **数据隔离** - 多租户数据隔离

### 3. 支持灵活部署

以多种模式部署应用:

```bash
# 独立模式 - 单个 .oos 文件
./myapp.oos

# 服务器模式 - Docker 容器
docker run -p 3000:3000 myapp:latest

# 多租户 SaaS 模式
docker run -e MULTI_TENANT=true myapp:latest
```

## 平台架构

```
┌─────────────────────────────────────────────────────┐
│                   应用层                             │
│                (您的业务逻辑)                        │
└──────────────────────┬──────────────────────────────┘
                       │
┌──────────────────────▼──────────────────────────────┐
│                 ObjectOS 平台                       │
│  ┌──────────────────────────────────────────────┐  │
│  │            身份与访问层                       │  │
│  │   ┌────────┬────────┬──────────────────┐    │  │
│  │   │  用户  │  角色  │  权限(FLS)       │    │  │
│  │   └────────┴────────┴──────────────────┘    │  │
│  └──────────────────────────────────────────────┘  │
│  ┌──────────────────────────────────────────────┐  │
│  │              QL-UI 绑定层                     │  │
│  │   ┌──────────────────┬──────────────────┐   │  │
│  │   │   ObjectUI       │    ObjectQL      │   │  │
│  │   │   (展示层)       │   (数据引擎)     │   │  │
│  │   └──────────────────┴──────────────────┘   │  │
│  └──────────────────────────────────────────────┘  │
│  ┌──────────────────────────────────────────────┐  │
│  │             存储抽象层                        │  │
│  │   ┌─────────┬──────────┬──────────────────┐ │  │
│  │   │ SQLite  │  MySQL   │   PostgreSQL     │ │  │
│  │   │ (本地)  │ (服务器) │   (服务器)       │ │  │
│  │   └─────────┴──────────┴──────────────────┘ │  │
│  └──────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────┘
```

## 使用场景

### 个人生产力应用

构建完全离线运行的本地优先应用:

```typescript
const app = new ObjectOS({
  mode: 'standalone',
  storage: '~/.myapp/data.db'
})
```

### 团队协作工具

部署带用户管理的服务器应用:

```typescript
const app = new ObjectOS({
  mode: 'server',
  database: 'mysql://localhost/myapp',
  auth: {
    providers: ['email', 'oauth']
  }
})
```

### 多租户 SaaS 平台

构建具有完整租户隔离的 SaaS 应用:

```typescript
const app = new ObjectOS({
  mode: 'multi-tenant',
  tenantStrategy: 'virtualCity',
  database: 'postgresql://localhost/saas'
})
```

## 您将学到什么

在本章节中,您将了解:

- ✅ **平台架构** - ObjectOS 如何绑定 QL 和 UI
- ✅ **身份与访问** - 用户系统、RBAC 和字段级安全
- ✅ **部署与运维** - 独立模式、服务器模式和多租户模式
- ✅ **最佳实践** - 安全配置和优化技巧

## 开始学习

准备好深入了解了吗?从这里开始:

1. **[平台架构](/docs/objectos/platform-architecture)** - 理解 ObjectOS 的工作原理
2. **[身份与访问](/docs/objectos/identity-access)** - 设置用户和权限
3. **[部署与运维](/docs/objectos/deployment)** - 部署您的应用

## 快速示例

这里有一个完整的示例帮您入门:

```typescript
import { ObjectOS } from '@objectstack/os'

// 1. 使用 schema 和 UI 初始化 ObjectOS
const app = new ObjectOS({
  mode: 'standalone',
  storage: './myapp.db',
  schema: {
    objects: {
      tasks: {
        fields: {
          name: { type: 'text', required: true },
          owner: { type: 'lookup', reference_to: '_users' }
        },
        permission_set: {
          user_permission: {
            allowCreate: true,
            allowRead: true,
            allowEdit: "owner eq $user.id",
            allowDelete: "owner eq $user.id"
          }
        }
      }
    }
  },
  pages: {
    home: {
      type: 'list',
      object: 'tasks'
    }
  }
})

// 2. 启动应用
await app.start()

console.log('ObjectOS 运行在 http://localhost:3000')
```

## 本地优先架构

ObjectOS 采用本地优先原则设计:

- **离线优先** - 应用无需网络连接即可工作
- **用户拥有数据** - 独立模式下数据保存在用户设备上
- **按需同步** - 可选的云服务同步
- **快速性能** - SQLite 驱动的本地存储

```typescript
// 本地优先配置
const app = new ObjectOS({
  mode: 'standalone',
  storage: './local-data.db',
  sync: {
    enabled: false,  // 完全离线
    // 或启用同步:
    // remote: 'https://sync.example.com',
    // strategy: 'manual'
  }
})
```

## 下一步

开始您的 ObjectOS 之旅:

- **初次接触 ObjectOS?** 从[平台架构](/docs/objectos/platform-architecture)开始
- **设置安全?** 跳转到[身份与访问](/docs/objectos/identity-access)
- **准备部署?** 查看[部署与运维](/docs/objectos/deployment)
