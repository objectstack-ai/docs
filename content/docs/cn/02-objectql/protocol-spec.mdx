---
title: 协议规范
description: ObjectQL 协议规范概述和参考指南
---

# 协议规范

ObjectQL 使用协议驱动的架构,提供涵盖数据建模、查询、聚合和变更操作的综合规范。该规范确保实现之间的一致性,并为开发人员提供清晰的契约。

## 核心组件

ObjectQL 协议规范分为四个主要组件:

### [Schema 定义](/docs/02-objectql/schema-definition)

定义数据模型:
- **对象定义** - 带有元数据的数据库表
- **字段类型** - 文本、数值、日期/时间、布尔、选择、关系和特殊字段
- **字段约束** - 验证、索引和依赖关系

### [查询 DSL](/docs/02-objectql/query-dsl)

查询数据:
- **过滤器** - 比较、字符串、列表、空值和复合运算符
- **排序** - 单字段或多字段排序
- **分页** - 使用 limit 和 skip 实现高效的数据检索
- **字段选择** - 选择特定字段,包括相关数据

### [聚合操作](/docs/02-objectql/aggregation)

分析数据:
- **GroupBy** - 按一个或多个字段对记录分组
- **聚合函数** - 计数、求和、平均值、最小值、最大值、去重计数
- **Having 子句** - 过滤聚合结果
- **聚合前后过滤** - WHERE 和 HAVING 子句

### [变更操作](/docs/02-objectql/mutation)

修改数据:
- **插入** - 创建新记录
- **更新** - 修改现有记录
- **删除** - 删除记录
- **批量操作** - 高效的批量操作

## 协议原则

ObjectQL 协议遵循以下关键原则:

1. **声明式** - 描述你想要什么,而不是如何获取
2. **类型安全** - 强类型保证可靠性
3. **可组合** - 从简单的构建块构建复杂的操作
4. **高效** - 针对大规模性能优化
5. **一致性** - 所有操作采用统一的模式

## 快速开始

这是一个使用所有协议组件的完整示例:

```typescript
// 1. 定义 schema
const schema = {
  objects: {
    customer: {
      label: '客户',
      fields: {
        name: { type: 'text', required: true },
        email: { type: 'email', unique: true },
        status: { type: 'select', options: ['active', 'inactive'] }
      }
    }
  }
}

// 2. 插入数据
await db.mutation('customer', {
  action: 'insert',
  data: { name: 'Acme Corp', email: 'contact@acme.com', status: 'active' }
})

// 3. 查询数据
const customers = await db.query('customer', {
  filters: [['status', '=', 'active']],
  sort: 'name asc',
  limit: 10
})

// 4. 聚合数据
const stats = await db.aggregate('customer', {
  group_by: ['status'],
  fields: [{ field: '_id', function: 'count', alias: 'total' }]
})
```

## 下一步

- 从[Schema 定义](/docs/02-objectql/schema-definition)开始建模数据
- 学习[查询 DSL](/docs/02-objectql/query-dsl)检索数据
- 掌握[聚合操作](/docs/02-objectql/aggregation)进行数据分析
- 理解[变更操作](/docs/02-objectql/mutation)修改数据
- 探索[核心功能](/docs/02-objectql/core-features)了解高级功能
- 查看[核心概念](/docs/02-objectql/core-concepts)了解基础知识
