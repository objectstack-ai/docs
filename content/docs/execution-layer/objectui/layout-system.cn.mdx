---
title: 布局系统
description: 使用 Stack、Grid、Tabs、Wizard 和 Master-Detail 布局构建复杂应用程序结构。
---

# 布局系统

在 ObjectUI 中，布局是**递归容器**。布局组件不保存数据本身；它保存其他组件（`children`）并定义它们如何在空间上排列。

通过将简单原语（Stack、Grid）与高级模式（Master-Detail、Wizard）结合，你可以构建任何企业界面。

## 1. 原子布局

这些是构建块，直接映射到 CSS Flexbox 和 Grid。

### Stack (`layout.stack`)
垂直或水平排列子项（Flexbox）。

```json
{
  "type": "layout.stack",
  "props": {
    "direction": "vertical", // 或 "horizontal"
    "gap": 4, // Tailwind 间距单位 (1rem)
    "align": "start"
  },
  "children": [ ... ]
}

```

### Grid (`layout.grid`)

在 2D 响应式网格中排列子项。

```json
{
  "type": "layout.grid",
  "props": {
    "columns": { "sm": 1, "md": 2, "lg": 4 }, // 响应式断点
    "gap": 6
  },
  "children": [ ... ]
}

```

### Card (`layout.card`)

标准表面容器，带有页眉、正文和页脚。

```json
{
  "type": "layout.card",
  "props": { "title": "Customer Info" },
  "children": [ ... ]
}

```

## 2. 导航布局

用于组织高密度信息。

### Tabs (`layout.tabs`)

在单独的窗格中延迟加载内容。

```json
{
  "type": "layout.tabs",
  "props": { "defaultValue": "details" },
  "children": [
    {
      "label": "Details",
      "value": "details",
      "content": { "type": "form", ... }
    },
    {
      "label": "Related Tasks",
      "value": "tasks",
      "content": { "type": "view.grid", "object": "task", ... }
    }
  ]
}

```

### Wizard / Stepper (`layout.wizard`)

引导用户完成多步骤流程。引擎自动处理"下一步/返回"逻辑和验证（例如，如果第 1 步无效，你无法进入第 2 步）。

```json
{
  "type": "layout.wizard",
  "props": {
    "onComplete": { "action": "submit_order" }
  },
  "children": [
    {
      "title": "Select Product",
      "content": { "type": "form", "fields": ["product", "qty"] }
    },
    {
      "title": "Shipping Info",
      "content": { "type": "form", "fields": ["address", "city"] }
    },
    {
      "title": "Payment",
      "content": { "type": "form", "fields": ["cc_number"] }
    }
  ]
}

```

## 3. 企业模式

这些是为 ERP/CRM 场景设计的专用布局。

### Master-Detail (`layout.master_detail`)

"圣杯"数据输入。它允许在一个屏幕上编辑父记录及其子项（行项）。

```json
{
  "type": "layout.master_detail",
  "props": {
    "master_object": "order",
    "detail_object": "order_line",
    "detail_field": "lines" // 一对多关系字段
  },
  "children": [
    {
      "region": "master",
      "content": { 
        "type": "form", 
        "fields": ["customer", "date", "status"] 
      }
    },
    {
      "region": "detail",
      "content": { 
        "type": "view.grid", 
        "editable": true, // 启用内联编辑
        "columns": ["product", "quantity", "price", "subtotal"]
      }
    }
  ]
}

```

### Dashboard (`layout.dashboard`)

专用于小部件和图表的拖放网格。

```json
{
  "type": "layout.dashboard",
  "props": {
    "editable": true // 允许用户调整大小/移动小部件
  },
  "children": [
    {
      "x": 0, "y": 0, "w": 6, "h": 4,
      "content": { "type": "chart.bar", "title": "Sales by Month" }
    },
    {
      "x": 6, "y": 0, "w": 6, "h": 4,
      "content": { "type": "view.list", "title": "Recent Activities" }
    }
  ]
}

```

## 4. 响应式和自适应规则

ObjectUI 布局默认是"移动优先"的，但你可以为不同的外形规格定义特定规则。

### `hidden` 表达式

每个布局节点都支持一个 `hidden` 属性，可以计算逻辑字符串。

```json
{
  "type": "layout.card",
  "props": { "title": "Admin Settings" },
  "hidden": "!user.is_admin || screen.width < 768", // 仅向桌面上的管理员显示
  "children": [...]
}

```

### `variant` 属性

布局可以根据上下文改变外观。

* `layout.stack` 带有 `variant: "split"` 可能在桌面上呈现侧边栏 + 主内容，但在移动设备上呈现抽屉菜单。

## 总结

| 布局 | 用例 |
| --- | --- |
| **Stack / Grid** | 通用对齐。 |
| **Card / Section** | 视觉上对相关字段进行分组。 |
| **Tabs** | 组织大型表单（例如，"常规"、"高级"、"审计"）。 |
| **Wizard** | 线性流程（结账、入职）。 |
| **Master-Detail** | 交易文档（发票、订单）。 |
| **Dashboard** | KPI 监控和高级概览。 |

